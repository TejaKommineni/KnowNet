%%% -*-LaTeX-*-

\chapter{Related Work}

In this chapter, we review works that relate to usage of Machine Learning/Data Mining techniques in the area of networking and discuss in detail how researches are using these methods for different purposes. We also put in to the context how our problem statement and solution differ from the existing work and advances the state of the art.

First, we review the different ML/DM approaches that are being used for traffic classification and intrusion detection in the area of cyber security.

Second, we survey the vast body of work that does packet based inspection and also analyze the shift of research focus towards inspecting at higher granularities specifically the flow based inspection techniques.

Finally, we discuss how unsupervised approaches are being used to look at network data at higher granularities and compare our solution with the prior work. 



\section{Data Mining and Machine Learning Techniques for Intrusion Detection}

There are many papers published in the area of cyber security describing the different ML/DM techniques used. Buczak et al \cite{buczak2016survey} provided a survey of  the popular techniques used and thoroughly describe ML/DM methods which provides a good starting point to people who intend to do research in the area of ML/DM for intrusion detection.

The survey by Buczak et al \cite{buczak2016survey} concentration has been mainly on explaining the ML and DM methods where as Bhuyan et al. \cite{bhuyan2014network} in his paper described different techniques used for network anomaly detection in detail. Garcia's work \cite{garcia2009anomaly} also explained different intrusion techniques in detail. He extended his work to  use Machine Learning techniques for anomaly detection with focus on signature based intrusion-detection.
Narayan et al. \cite{peddabachigari2007modeling} proposed a hybrid classification method utilizing both Naive Bayes and decision trees for intrusion detection. While their findings had higher accuracy applying these supervised techniques to our dataset was not feasible as we had very less labeled data.

Wired networks generally have multiple layers of security before the intruder enters the network. But, the wireless networks are more vulnerable to malicious attacks. They add a whole new semantics to the network security such as dynamically changing topology, different authentication techniques and ad-hoc formation of networks. The process  followed in this paper works in the context of both wired and wireless networks. Zhang et al. in his work \cite{zhang2003intrusion} provides a perspective focused only on wireless network protection.

\section{Machine Learning for Traffic Classification}

Apart form using ML/DM techniques for intrusion detection one other field where these have been extensively used is to classify the network data. The survey \cite{nguyen2008survey} lists the prominent ML/DM techniques used to classify the data and describes the need for traffic classification. In order to provide the promised Quality of service and be liable to the government laws network administrators should be able to distinguish the traffic on their network. 

Traditional well-known port number based classification is not sufficient on it's own to distinguish different applications  as different services are using http protocol to send their data and obfuscate from the traffic classifiers. Also, papers such as choicenet \cite{wolf2014choicenet} point out that to develop an economy plane for the internet similar to the implicit content based billing architecture in mobile architecture there is need for network administrators to classify the network data.

Naive Bayes form is the simplest technique used for this type of classification and has been explained in greater detail in the work of Andrew and Denis \cite{moore2005internet}. This work was extended by applying Bayesian neural network approach \cite{auld2007bayesian} for increasing the accuracy. Though these classification techniques proved to be efficient in differentiating network data they have a drawback that they can only distinguish the network data into known classes which is in contrast to our goal of identifying implicit behavior which is not known in advance.

Renata\cite{bernaille2006traffic} looked at unsupervised techniques for traffic classification. In contrast to the existing approaches he followed a principle of early detection. Accordingly, he looked at the first few packets of tcp flow and classified them into different applications. The underlying logic behind this method is that during handshake process each application behaves in a specific way exchanging a particular sequence of messages. 
He used K-Means algorithm to form clusters. Initially, training data collected over a period  is used to generate a model which gives a set of clusters. When new data arrives simple Euclidean distance is used to map this flow to a cluster. The flow belongs to the cluster which it is closest to. Though, this approach had 80 accuracy it has few drawbacks, If we cannot capture initial few packets of a service it's effectiveness is compromised. If a flow doesn't fall under any cluster the behavior is undefined.
Renata's \cite{bernaille2006traffic} approach was similar to us as we also explored unsupervised techniques in our system but they differ in the point that they examine the packet data and map their clusters to only known classes of traffic.

Jeffrey and Mahanti et al. \cite{erman2007semi} explored hybrid techniques for traffic classification. The intuition behind this exploration is that not all data available will be labeled and when data from new services get appended to the existing dataset the supervised learning techniques are falling short in recognizing them and they map the new data set to one of the existing classes. To overcome this shortcoming they approached the problem in two steps. In the first step the dataset containing labeled and unlabeled data is passed to a clustering algorithm. In the second step the labeled data is used to classify clusters and this is done as follows: Within each cluster all the labeled data is considered and the label with majority forms the label of this cluster. Clusters without any labeled data are classified as 'Unknown'. When new data arrives it will be assigned based on the Euclidean distance to the closest cluster similar to \cite{bernaille2006traffic} . This has combined advantages of supervised and unsupervised learning. It also decreases the training time because of few labeled data. It's uniqueness comes from being able to map the data from new applications and services to Unknown cluster or to their respective clusters if they are simple variation of existing application's characteristics. A slight variation of this approach has been used by us during our experiments and the following issues have been noticed. First, there were cases in which we have seen a cluster mapping to multiple labels as both turned out to be major labels in the cluster differing by a small value. In this case labeling a cluster just based on majority doesn't suggest the clusters behavior. Second, the amount  of labeled data could be negligible compared to the size of the cluster. Third, two clusters could turn out to have similar labels. Lastly, the time consumed for this two step approach is high as we had to iterate through the data twice. Noticing that this technique isn't inline with  our goals we have embraced a totally unsupervised approach for our problem.


\section{Usage of flow records for IDS/Classification}

Traditionally Network data inspection is done by inspecting the contents of every packet. But, the granularity at which this is happening is changing based on the requirements. Earlier packet inspection is used to be a norm but inspecting the contents of every packet is prohibitive in this data-centric age. In this section we look at how flows (aggregated packet data) are being used as input for ML/DM algorithms in place of packets.

In our opinion, flow-based detection should not be seen as a replacement but should be treated as a complement to packet based inspection. We envision that a network administrator should be able to understand the behavior of his network through an aggregated view of network data (in our case flows) and should dive into packet data only when suspicious about a activity. This two step approach will ease the way the network administrators manage their network.

Work of Li et al. \cite{gao2005towards} and Gao et al. \cite{gao2006resilient} are two examples of Dos detection using flows. In their approach a process tracks the presence of a flow in a specified time frame and an other process runs an anomaly-based engine that triggers if there is a sharp variation from the expected mean. A similar approach was proposed by Zhao et al.\cite{zhao2006detection} to identify the IP addresses of the Scanning hosts and Dos attackers using the flow data. Our system though uses flows captures a broader view apart from identifying these specific attacks. Network Flows are also used in building Worm Detectors \cite{dubendorfer2005framework} \cite{diibendorfer2005host}, Botnet Detectors \cite{strayer2008botnet} \cite{livadas2006usilng} \cite{karasaridis2007wide}. Specifically, the botnet detector built by Livadas et al.  \cite{livadas2006usilng} is of interest as they  build a model using the aggregated flows similar to ours.

